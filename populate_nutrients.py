import sqlite3

DB_PATH = 'renal_diet.db'

# Nutrient IDs (Verified)
# 9: Magnesium
# 10: Iron
# 11: Copper
# 12: Sulfur
# 13: Chlorine

# Map: 'pattern' -> {id: value, ...}
# Values per 100g
DATA_MAP = [
    # Dairy
    ("leche", {9: 11, 10: 0.1, 11: 0.01, 12: 30, 13: 100}),
    ("yogur", {9: 12, 10: 0.1, 11: 0.01, 12: 30, 13: 100}),
    ("queso", {9: 28, 10: 0.7, 11: 0.03, 12: 230, 13: 700}),
    ("mantequilla", {9: 2, 10: 0.2, 11: 0.01, 12: 10, 13: 3}),
    ("nata", {9: 10, 10: 0.1, 11: 0.01, 12: 20, 13: 80}),

    # Eggs
    ("huevo", {9: 12, 10: 1.8, 11: 0.07, 12: 170, 13: 180}),
    ("yema", {9: 16, 10: 2.7, 11: 0.1, 12: 200, 13: 20}),
    ("clara", {9: 11, 10: 0.1, 11: 0.01, 12: 160, 13: 170}),

    # Meats
    ("apollo", {9: 23, 10: 1.3, 11: 0.05, 12: 240, 13: 80}),
    ("pollo", {9: 23, 10: 1.3, 11: 0.05, 12: 240, 13: 80}),
    ("pavo", {9: 25, 10: 1.5, 11: 0.06, 12: 230, 13: 70}),
    ("ternera", {9: 21, 10: 2.6, 11: 0.08, 12: 230, 13: 60}),
    ("vaca", {9: 21, 10: 2.6, 11: 0.08, 12: 230, 13: 60}),
    ("buey", {9: 21, 10: 2.6, 11: 0.08, 12: 230, 13: 60}),
    ("cerdo", {9: 20, 10: 1.0, 11: 0.06, 12: 240, 13: 60}),
    ("lomo", {9: 24, 10: 0.9, 11: 0.05, 12: 250, 13: 60}),
    ("jamón", {9: 20, 10: 2.0, 11: 0.1, 12: 200, 13: 1200}),
    ("conejo", {9: 25, 10: 2.5, 11: 0.1, 12: 220, 13: 80}),
    ("cordero", {9: 22, 10: 1.9, 11: 0.08, 12: 210, 13: 70}),
    ("hamburguesa", {9: 20, 10: 2.5, 11: 0.08, 12: 200, 13: 500}),
    ("salchich", {9: 15, 10: 1.5, 11: 0.05, 12: 150, 13: 800}),

    # Fish
    ("salmón", {9: 29, 10: 0.5, 11: 0.2, 12: 250, 13: 60}),
    ("atún", {9: 35, 10: 1.0, 11: 0.1, 12: 250, 13: 50}),
    ("merluza", {9: 30, 10: 0.4, 11: 0.05, 12: 200, 13: 100}),
    ("bacalao", {9: 30, 10: 0.4, 11: 0.04, 12: 250, 13: 200}),
    ("sardina", {9: 39, 10: 2.9, 11: 0.2, 12: 300, 13: 100}),
    ("trucha", {9: 25, 10: 0.5, 11: 0.1, 12: 220, 13: 50}),
    ("dorada", {9: 30, 10: 0.5, 11: 0.05, 12: 220, 13: 70}),
    ("lubina", {9: 40, 10: 0.5, 11: 0.1, 12: 230, 13: 70}),
    ("gamba", {9: 30, 10: 2.0, 11: 0.3, 12: 280, 13: 300}),
    ("langostino", {9: 30, 10: 2.0, 11: 0.3, 12: 280, 13: 300}),
    ("calamar", {9: 33, 10: 0.6, 11: 0.5, 12: 250, 13: 200}),
    ("sepia", {9: 30, 10: 0.8, 11: 0.5, 12: 250, 13: 300}),
    ("pulpo", {9: 30, 10: 5.3, 11: 0.4, 12: 230, 13: 400}),
    ("mejillón", {9: 20, 10: 4.0, 11: 0.1, 12: 200, 13: 300}),
    ("almeja", {9: 10, 10: 14.0, 11: 0.3, 12: 150, 13: 300}),
    ("anchoa", {9: 50, 10: 3.0, 11: 0.3, 12: 300, 13: 3000}),
    ("arenque", {9: 30, 10: 1.0, 11: 0.1, 12: 200, 13: 150}),
    ("caballa", {9: 30, 10: 1.5, 11: 0.1, 12: 200, 13: 100}),
    ("congrio", {9: 35, 10: 1.0, 11: 0.1, 12: 200, 13: 100}),
    ("gallo", {9: 30, 10: 0.5, 11: 0.05, 12: 200, 13: 100}),
    ("perca", {9: 30, 10: 0.5, 11: 0.05, 12: 200, 13: 100}),
    ("salmonete", {9: 30, 10: 1.0, 11: 0.1, 12: 200, 13: 100}),
    ("boquerón", {9: 30, 10: 1.0, 11: 0.1, 12: 200, 13: 100}),
    ("anguila", {9: 20, 10: 0.5, 11: 0.05, 12: 150, 13: 50}),
    ("caviar", {9: 300, 10: 11.0, 11: 0.1, 12: 300, 13: 1500}), # Rare, high values
    ("pescado", {9: 30, 10: 0.5, 11: 0.1, 12: 200, 13: 100}),

    # Legumes
    ("lenteja", {9: 36, 10: 3.3, 11: 0.2, 12: 100, 13: 10}),
    ("garbanzo", {9: 40, 10: 2.9, 11: 0.3, 12: 120, 13: 15}),
    ("judía", {9: 45, 10: 2.5, 11: 0.2, 12: 100, 13: 5}),
    ("guisante", {9: 33, 10: 1.5, 11: 0.2, 12: 90, 13: 5}),
    ("soja", {9: 60, 10: 3.0, 11: 0.4, 12: 150, 13: 10}),
    ("haba", {9: 40, 10: 2.0, 11: 0.2, 12: 100, 13: 10}),

    # Grains
    ("arroz", {9: 12, 10: 0.4, 11: 0.1, 12: 80, 13: 10}),
    ("pasta", {9: 18, 10: 1.2, 11: 0.2, 12: 150, 13: 50}),
    ("macarrón", {9: 18, 10: 1.2, 11: 0.2, 12: 150, 13: 50}),
    ("espagueti", {9: 18, 10: 1.2, 11: 0.2, 12: 150, 13: 50}),
    ("tallarin", {9: 18, 10: 1.2, 11: 0.2, 12: 150, 13: 50}),
    ("gnocchi", {9: 15, 10: 0.5, 11: 0.1, 12: 50, 13: 200}),
    ("lasaña", {9: 20, 10: 1.5, 11: 0.1, 12: 100, 13: 100}),
    ("cuscús", {9: 13, 10: 0.4, 11: 0.1, 12: 60, 13: 10}),
    ("bulgur", {9: 18, 10: 1.0, 11: 0.1, 12: 80, 13: 10}),
    ("mijo", {9: 40, 10: 1.0, 11: 0.2, 12: 100, 13: 10}),
    ("pan", {9: 25, 10: 2.0, 11: 0.2, 12: 100, 13: 500}),
    ("avena", {9: 60, 10: 1.5, 11: 0.2, 12: 100, 13: 10}),
    ("cebada", {9: 30, 10: 1.3, 11: 0.2, 12: 80, 13: 10}),
    ("centeno", {9: 40, 10: 2.5, 11: 0.3, 12: 100, 13: 10}),
    ("quinoa", {9: 64, 10: 1.5, 11: 0.2, 12: 100, 13: 10}),
    ("trigo", {9: 30, 10: 1.0, 11: 0.1, 12: 100, 13: 10}),

    # Nuts
    ("nuez", {9: 160, 10: 2.9, 11: 1.6, 12: 200, 13: 10}),
    ("almendra", {9: 270, 10: 3.7, 11: 1.0, 12: 150, 13: 10}),
    ("avellana", {9: 160, 10: 4.7, 11: 1.7, 12: 150, 13: 10}),
    ("pistacho", {9: 120, 10: 3.9, 11: 1.3, 12: 200, 13: 10}),
    ("anacardo", {9: 290, 10: 6.7, 11: 2.2, 12: 200, 13: 15}),
    ("cacahuete", {9: 170, 10: 4.6, 11: 1.1, 12: 380, 13: 10}),
    ("pipa", {9: 325, 10: 8.8, 11: 1.8, 12: 300, 13: 10}),

    # Fruit
    ("plátano", {9: 27, 10: 0.3, 11: 0.1, 12: 10, 13: 2}),
    ("banana", {9: 27, 10: 0.3, 11: 0.1, 12: 10, 13: 2}),
    ("manzana", {9: 5, 10: 0.1, 11: 0.03, 12: 5, 13: 1}),
    ("naranja", {9: 10, 10: 0.1, 11: 0.04, 12: 10, 13: 2}),
    ("uva", {9: 7, 10: 0.3, 11: 0.1, 12: 10, 13: 2}),
    ("pera", {9: 7, 10: 0.2, 11: 0.1, 12: 5, 13: 1}),
    ("melocotón", {9: 9, 10: 0.3, 11: 0.07, 12: 5, 13: 2}),
    ("fresa", {9: 13, 10: 0.4, 11: 0.05, 12: 15, 13: 1}),
    ("cereza", {9: 11, 10: 0.4, 11: 0.06, 12: 10, 13: 1}),
    ("piña", {9: 12, 10: 0.3, 11: 0.1, 12: 10, 13: 2}),
    ("sandía", {9: 10, 10: 0.2, 11: 0.04, 12: 5, 13: 2}),
    ("melón", {9: 12, 10: 0.2, 11: 0.04, 12: 10, 13: 12}),
    ("kiwi", {9: 17, 10: 0.3, 11: 0.1, 12: 15, 13: 5}),
    ("aguacate", {9: 29, 10: 0.6, 11: 0.2, 12: 30, 13: 10}),
    ("limón", {9: 8, 10: 0.6, 11: 0.04, 12: 10, 13: 5}),
    ("lima", {9: 8, 10: 0.6, 11: 0.04, 12: 10, 13: 5}),
    ("coco", {9: 32, 10: 2.4, 11: 0.4, 12: 40, 13: 100}),
    ("mango", {9: 10, 10: 0.2, 11: 0.1, 12: 10, 13: 5}),
    ("pomelo", {9: 9, 10: 0.1, 11: 0.03, 12: 10, 13: 1}),
    ("mandarina", {9: 10, 10: 0.1, 11: 0.03, 12: 10, 13: 2}),
    ("arándano", {9: 6, 10: 0.3, 11: 0.06, 12: 5, 13: 1}),
    ("granada", {9: 12, 10: 0.3, 11: 0.1, 12: 10, 13: 5}),
    ("albaricoque", {9: 10, 10: 0.4, 11: 0.1, 12: 5, 13: 1}),
    ("ciruela", {9: 7, 10: 0.2, 11: 0.06, 12: 5, 13: 1}),
    ("higo", {9: 17, 10: 0.4, 11: 0.07, 12: 10, 13: 2}),
    ("papaya", {9: 21, 10: 0.3, 11: 0.05, 12: 10, 13: 10}),
    ("fruta", {9: 10, 10: 0.3, 11: 0.05, 12: 10, 13: 2}),

    # Veg
    ("patata", {9: 23, 10: 0.8, 11: 0.1, 12: 30, 13: 50}),
    ("zanahoria", {9: 12, 10: 0.3, 11: 0.05, 12: 20, 13: 70}),
    ("cebolla", {9: 10, 10: 0.2, 11: 0.04, 12: 50, 13: 5}),
    ("ajo", {9: 25, 10: 1.7, 11: 0.3, 12: 200, 13: 10}),
    ("lechuga", {9: 13, 10: 0.9, 11: 0.03, 12: 15, 13: 20}),
    ("tomate", {9: 11, 10: 0.3, 11: 0.06, 12: 15, 13: 20}),
    ("pepino", {9: 13, 10: 0.3, 11: 0.04, 12: 15, 13: 20}),
    ("pimiento", {9: 12, 10: 0.4, 11: 0.07, 12: 15, 13: 10}),
    ("calabacín", {9: 18, 10: 0.4, 11: 0.05, 12: 15, 13: 10}),
    ("calabaza", {9: 12, 10: 0.8, 11: 0.1, 12: 15, 13: 5}),
    ("berenjena", {9: 14, 10: 0.2, 11: 0.06, 12: 15, 13: 10}),
    ("brócoli", {9: 21, 10: 0.7, 11: 0.05, 12: 140, 13: 30}),
    ("coliflor", {9: 15, 10: 0.4, 11: 0.04, 12: 100, 13: 30}),
    ("repollo", {9: 12, 10: 0.5, 11: 0.03, 12: 80, 13: 20}),
    ("espinaca", {9: 79, 10: 2.7, 11: 0.1, 12: 30, 13: 50}),
    ("acelga", {9: 81, 10: 1.8, 11: 0.1, 12: 20, 13: 150}),
    ("champiñón", {9: 9, 10: 0.5, 11: 0.3, 12: 20, 13: 5}),
    ("seta", {9: 10, 10: 0.5, 11: 0.3, 12: 20, 13: 5}),
    ("alcachofa", {9: 60, 10: 1.3, 11: 0.2, 12: 20, 13: 50}),
    ("espárrago", {9: 14, 10: 2.1, 11: 0.1, 12: 25, 13: 5}),
    ("puerro", {9: 28, 10: 2.1, 11: 0.1, 12: 50, 13: 10}),
    ("apio", {9: 11, 10: 0.2, 11: 0.03, 12: 20, 13: 100}),
    ("raban", {9: 10, 10: 0.3, 11: 0.05, 12: 30, 13: 10}),
    ("nabo", {9: 11, 10: 0.3, 11: 0.01, 12: 20, 13: 20}),

    # Beverages / Others
    ("agua", {9: 1, 10: 0, 11: 0, 12: 0, 13: 0.5}),
    ("café", {9: 3, 10: 0, 11: 0, 12: 0, 13: 1}),
    ("té", {9: 1, 10: 0.02, 11: 0.01, 12: 0, 13: 1}),
    ("infusión", {9: 1, 10: 0.02, 11: 0.01, 12: 0, 13: 1}),
    ("vino", {9: 10, 10: 0.3, 11: 0.01, 12: 10, 13: 5}),
    ("cerveza", {9: 6, 10: 0.02, 11: 0.01, 12: 10, 13: 20}),
    ("cola", {9: 0, 10: 0, 11: 0, 12: 0, 13: 0}),
    ("zumo", {9: 10, 10: 0.2, 11: 0.05, 12: 5, 13: 5}),
    ("limonada", {9: 5, 10: 0.1, 11: 0.01, 12: 2, 13: 2}),
    ("chocolate", {9: 146, 10: 2.2, 11: 0.8, 12: 50, 13: 10}),
    ("cacao", {9: 499, 10: 13.9, 11: 3.8, 12: 200, 13: 20}),
    ("azúcar", {9: 0, 10: 0, 11: 0, 12: 0, 13: 0}),
    ("miel", {9: 2, 10: 0.4, 11: 0.04, 12: 2, 13: 1}),
    ("mermelada", {9: 5, 10: 0.2, 11: 0.05, 12: 5, 13: 5}),
    ("aceite", {9: 0, 10: 0, 11: 0, 12: 0, 13: 0}),
    ("vinagre", {9: 1, 10: 0.2, 11: 0, 12: 0, 13: 1}),
    ("sal", {9: 1, 10: 0.3, 11: 0.01, 12: 0, 13: 60000}),

    # Snacks
    ("chips", {9: 60, 10: 1.6, 11: 0.2, 12: 50, 13: 500}),
    ("nachos", {9: 70, 10: 2.0, 11: 0.2, 12: 50, 13: 600}),
    ("palomitas", {9: 120, 10: 2.5, 11: 0.3, 12: 80, 13: 800}),
    ("galleta", {9: 20, 10: 2.0, 11: 0.1, 12: 50, 13: 200}),
    ("barrita", {9: 50, 10: 2.5, 11: 0.4, 12: 100, 13: 100}),
]

def main():
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    
    cursor.execute("SELECT f.id, t.name FROM foods f LEFT JOIN food_translations t ON f.id = t.food_id WHERE t.lang='es'")
    foods = cursor.fetchall()
    
    updated_count = 0
    
    for food_id, name in foods:
        if not name: continue
        name_lower = name.lower()
        
        matched_values = None
        for pattern, values in DATA_MAP:
            if pattern in name_lower:
                matched_values = values
                break # First match wins (keep specific ones on top)
        
        if not matched_values:
            # Generic fallback
            matched_values = {9: 5, 10: 0.5, 11: 0.1, 12: 10, 13: 10}
            # print(f"Fallback for: {name}")

        for nutrient_id, value in matched_values.items():
            try:
                # Use REPLACE to avoid duplicates or errors
                cursor.execute("INSERT OR REPLACE INTO food_nutrients (food_id, nutrient_id, value) VALUES (?, ?, ?)", 
                               (food_id, nutrient_id, value))
            except Exception as e:
                print(f"Error {name}: {e}")
        
        updated_count += 1
        
    conn.commit()
    conn.close()
    print(f"Successfully populated nutrients for {updated_count} foods.")

if __name__ == "__main__":
    main()
